<p>
Like in  angular1 you can use events in angular2. 
What events good for? To make distant components to notify one to another.
</p>


<h3>How to send event</h3>
<p>
Everybody knows that for sending event you need to create some kind of channel. This channel will be used to publish(<strong>emit</strong>) event and to <strong>subscribe</strong> to event for getting notified .
Angular2 has its own <strong>EventEmitter</strong> class just for this scenario<br />

<pre>
<code class="language-javascript">
import {Injectable, EventEmitter} from 'angular2/core';
@Injectable()
export class EmitterService {
  private static _emitters: { [channel: string]: EventEmitter<any> } = {};
  static get(channel: string): EventEmitter<any> {
    if (!this._emitters[channel]) 
      this._emitters[channel] = new EventEmitter();
    return this._emitters[channel];
  }
}
</code>
</pre>
This service sets some channel (if no channel exists) and stores it in the private member
</p>    


<h3>Challenge</h3>
<p>In this post i want to demonstrate usage of events by bulding a <strong>refresh chart</strong>  button, of the panel on which  a flot <a href="http://gs500coder.blogspot.co.il/2016/01/creating-chart-component-angular2.html">component</a> from older posts is located.<br/>
pressing on this button should refresh the data of the chart in the child flot component.
</p>

<a href="https://1.bp.blogspot.com/-btL-_qsU9GE/VxcNPj8ptxI/AAAAAAAAASs/Hw4XhFTgFLgS_Ka1w1TAWMOonkyeHvDegCLcB/s1600/refreshbtn.png" imageanchor="1" ><img border="0" src="https://1.bp.blogspot.com/-btL-_qsU9GE/VxcNPj8ptxI/AAAAAAAAASs/Hw4XhFTgFLgS_Ka1w1TAWMOonkyeHvDegCLcB/s320/refreshbtn.png" /></a>

<h3>Click Event</h3>
<p>
Sending and catching click event is pretty straightforward:<br/>
<strong>Sending</strong>
<pre>
<code class="language-javascript">
&lt;a href="#" panel-refresh="" (click)="chartRefresh();false"&gt;
    &lt;em class="fa fa-refresh"&gt;&lt;/em&gt;
&lt;/a&gt;
</code>
</pre>
<strong>Catching</strong>
<pre>
<code class="language-javascript">
  ...
  chartRefresh(){
   this.getEntries();
  }
  ...
</code>
</pre>
</p> 
<p>
The problem is to send custom event from parent component <strong>panel</strong><br/>
to its child conmponent <strong>flot</strong> that will cause chart to redraw itself.<br/>
This event must be fired after data loaded through ajax request.
<pre>
<code class="language-javascript">
  ...
    this.f.getFlotEntries()
      .subscribe(entries => {
        //here event is emitted
        this.e.emit('Broadcast');
      },
  ...
</code>
</pre>
</p>
<h3>Full Code Of Panel Component</h3>
<p>
<pre>
<code class="language-javascript">
import {Component} from 'angular2/core'
import {FlotCmp} from './flot';
import {FlotService} from './FlotService';
import {EmitterService} from './EmitterService';
import {Observable}     from 'rxjs/Observable';
import {HTTP_PROVIDERS}    from 'angular2/http';
import {Http, Response} from 'angular2/http';
@Component({
  selector: 'panel',
  providers: [],
  template: `
 &lt;div class="panel panel-default"&gt;
    &lt;h2 class="panel-heading"&gt;
    &lt;div class="pull-right"&gt;
    &lt;a href="#" panel-refresh="" (click)="chartRefresh();false"&gt;&lt;em class="fa fa-refresh"&gt;&lt;/em&gt;&lt;/a&gt;
    &lt;/div&gt;
    &lt;div&gt;panel heading&lt;/div&gt;
    &lt;/h2&gt;
    &lt;flot class="panel-body" height="250px" width="100%"&gt;&lt;/flot&gt;
 &lt;/div&gt;
  `,
  directives: [FlotCmp], 
  providers: [
    FlotService,
    EmitterService,
    HTTP_PROVIDERS
  ] 
})
export class Panel {
  
  constructor(private f:FlotService,private e:EmitterService) {
    
    this.e = EmitterService.get("channel_1"); 
    this.getEntries();
  }
  getEntries(){
    this.f.getFlotEntries()
      .subscribe(entries => {
        //here event is emitted
        this.e.emit('Broadcast');
      },
      error =>  {
        this.errorMessage = <any>error;
         console.log(error);
      });    
    
  }
  chartRefresh(){
   this.getEntries();
  }
}
</code>
</pre>
</p>


<h3>Handling event</h3>
<p>
Child component <strong>flot</strong>  responding to custom event from its parent.
<pre>
<code class="language-javascript">
   ...
   this.emitter.subscribe(msg => {      
       $.plot( plotArea, this.dataset, this.options);
   });
   ...
</code>
</pre>
</p>