After creating my <a href="http://gs500coder.blogspot.co.uk/2016/01/building-my-first-directive-with.html">first component</a> which displays current time, i want to try something little bit complicate.<br />
This time lets create a component which displays chart:<br />
<br />
<div class="separator" style="clear: both; text-align: center;">
<a href="http://3.bp.blogspot.com/-87mMYvcubjo/VqDo0aNZsOI/AAAAAAAAASc/ShsbWor87dg/s1600/chart.PNG" imageanchor="1" style="margin-left: 1em; margin-right: 1em;"><img border="0" height="100" src="http://3.bp.blogspot.com/-87mMYvcubjo/VqDo0aNZsOI/AAAAAAAAASc/ShsbWor87dg/s320/chart.PNG" width="320" /></a></div>
For draw a chart i will use <a href="http://www.flotcharts.org/">jquery flot</a>  library which is one of libraries/plugins which let you to create beautiful charts.<br />
According to jquery flot docs - for draw a chart you need to pass <strong>html element</strong>(selector), <strong>data</strong> and <strong>options</strong> to  plot plugin, like this:
<br />
<pre><code class="language-javascript">
$.plot( selector, dataset, options);
</code>
</pre>
<br />
<h2>
Component</h2>
As in previous case, lets create component<br />
<pre><code class="language-javascript">
import {Component, ElementRef} from 'angular2/core';

@Component({
  selector: 'flot',
  template: `&lt;div&gt;loading&lt;/div&gt;`

})

export class FlotCmp {
  private dataset;
  private options;
  private width = '100%';
  private height = 220;

  
  constructor(public el: ElementRef) {
        this.dataset = [{label: "line1",data:  [[1, 130], [2, 40], [3, 80], [4, 160], [5, 159], [6, 370], [7, 330], [8, 350], [9, 370], [10, 400], [11, 330], [12, 350]]}];
        this.options = {
            series: {
                lines: { show: true },
                points: {
                    radius: 3,
                    show: true
                }
            }
        };
        
        let plotArea = $(this.el.nativeElement).find('div');
        plotArea.css({
            width: this.width,
            height: this.height
        });
        $.plot( plotArea, this.dataset, this.options);

  }//end of constructor
}
</code>
</pre>
Yes!!! Now the chart s created!!!<br />
Note that for access the html element on which i want to apply the chart, i'v used <a href="https://angular.io/docs/js/latest/api/core/ElementRef-class.html">ElementRef</a> module 
<br />
<h2>
Passing properties</h2>
Our next goal is to make newly created component configurable - e.g. ability to pass 
<b>dataset</b>, <b>options</b>, <b>width</b>, <b>height</b> configuration properties through the attributes:
 <br />
<pre>  <code class="language-markup">
     &lt;flot [options]="splineOptions" [dataset]="dataset" height="550px" width="100%"&gt;&lt;/flot&gt;
 </code>
</pre>
"Piece of cake!"  you may say, like in previous case use the  <a href="https://angular.io/docs/ts/latest/api/core/Input-var.html">"input"</a> factory and you done:
<br />
<pre><code class="language-javascript">
import {Component, ElementRef, Input} from 'angular2/core';

@Component({
  selector: 'flot',
  template: `&lt;div&gt;loading&lt;/div&gt;`

})
//this will cause error!!!
export class FlotCmp{

  private width = '100%';
  private height = 220;
  static chosenInitialized = false;
  
  @Input() private  options: any;
  @Input() private  dataset:any;
  @Input() private  width:string;
  @Input() private  height:string;
      
   
  constructor(public el: ElementRef) {
        plotArea.css({
            width: this.width, 
            height: this.height
        });
        $.plot( plotArea, this.dataset, this.options);        
  }
  ...  
</code>
</pre>
Bad idea! No chart created anymore.<br />
But why? Because the constructor runs before input setters passing their values.
We must move plot initiating logic to some later phase. I find the solution <a href="http://stackoverflow.com/questions/30623825/how-to-use-jquery-with-angular2">here</a>. This guy uses  AfterViewInit factory:
<br />
<pre><code class="language-javascript">
import {Component, ElementRef, Input, AfterViewInit} from 'angular2/core';

@Component({
  selector: 'flot',
  template: `&lt;div&gt;loading&lt;/div&gt;`

})

export class FlotCmp  implements AfterViewInit{

  private width = '100%';
  private height = 220;
  static chosenInitialized = false;
  
  @Input() private  options: any;
  @Input() private  dataset:any;
  @Input() private  width:string;
  @Input() private  height:string;
 
  constructor(public el: ElementRef) {}

  ngAfterViewInit() {
      if(!FlotCmp.chosenInitialized) {
        let plotArea = $(this.el.nativeElement).find('div').empty();
        plotArea.css({
            width: this.width, 
            height: this.height
        });
        $.plot( plotArea, this.dataset, this.options);    
        FlotCmp.chosenInitialized = true;
      }
  } 
} 

</code>
</pre>
Now the chart initiating logic is in the <b>ngAfterViewInit</b> method which activates after properies already set.<br/>
<iframe  src="http://embed.plnkr.co/9YOjcdLZHoPnGg6bDoo0/" width="100%" height="400px" frameborder="0"></iframe>
Hope you have fun reading!<br/>
More <a href="http://blog.thoughtram.io/angular/2015/04/09/developing-a-tabs-component-in-angular-2.html">posts</a> about angular2 stuff (used for me as inspiration source)